<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<title>Universal Compatible Totally Normal Password Generator</title>

<!--
===============================================================================
  This file is intentionally insane.
  It is compatible with:
    - Modern browsers
    - Old browsers
    - Your patience
    - Or not.
===============================================================================
-->

<style>
body {
  background:#111;
  color:#0f0;
  font-family: monospace;
  margin:0;
  overflow:hidden;
}
#app {
  position:absolute;
  top:50%;
  left:50%;
  transform:translate(-50%,-50%);
  text-align:center;
}
button {
  padding:12px 20px;
  background:black;
  border:1px solid #0f0;
  color:#0f0;
  cursor:pointer;
}
.char {
  position:absolute;
  font-size:26px;
  pointer-events:none;
}
body.chaos #app { opacity:0.1; }
</style>
</head>

<body class="normal">

<div id="app">
  <h1>å¯†ç ç”Ÿæˆå™¨</h1>
  <button id="gen">ç”Ÿæˆå¯†ç </button>
  <button id="copy" style="display:none">å¤åˆ¶</button>
  <div id="status"></div>
</div>

<script>
/******************************************************************************
 * CORE SYSTEM
 *****************************************************************************/
const gen = document.getElementById("gen");
const copy = document.getElementById("copy");
const status = document.getElementById("status");

let chars = [];
let ready = false;
let timer = 10;
let timerId = null;
let flashId = null;

function fly(el) {
  el.style.left = Math.random()*90 + "vw";
  el.style.top = Math.random()*90 + "vh";
}

/******************************************************************************
 * BROWSER COMPATIBILITY LAYER (WINDOWS STYLE)
 *****************************************************************************/
const BrowserMatrix = {
  isChrome: !!window.chrome,
  isFirefox: typeof InstallTrigger !== 'undefined',
  isSafari: /^((?!chrome|android).)*safari/i.test(navigator.userAgent),
  isEdge: /Edg/.test(navigator.userAgent),
  isIE: !!document.documentMode,
  isAncient: navigator.userAgent.includes("MSIE") || navigator.userAgent.includes("Netscape")
};

function LegacyFetch(url) {
  if (window.fetch) return window._realFetch(url);
  return new Promise((resolve, reject) => {
    const xhr = new XMLHttpRequest();
    xhr.open("GET", url);
    xhr.onload = () => resolve({ text: () => xhr.responseText });
    xhr.onerror = reject;
    xhr.send();
  });
}

window._realFetch = window.fetch;
window.fetch = function(url) {
  return LegacyFetch(url);
};

const APIMappingTable = {
  "v0": "https://v2.xxapi.cn/api/password",
  "v1": "https://v2.xxapi.cn/api/password",
  "v2": "https://v2.xxapi.cn/api/password",
  "legacy": "https://v2.xxapi.cn/api/password",
  "future": "https://v2.xxapi.cn/api/password"
};

function CallSystemAPI(name) {
  return fetch(APIMappingTable[name] || APIMappingTable.v1);
}

/******************************************************************************
 * TIMER + RITUAL
 *****************************************************************************/
function startTimer() {
  ready = false;
  timer = 10;
  clearInterval(timerId);
  clearInterval(flashId);
  copy.style.display = "inline-block";
  copy.textContent = "ç­‰å¾… 10 ç§’";

  timerId = setInterval(() => {
    timer--;
    if (timer <= 0) {
      ready = true;
      clearInterval(timerId);
      status.textContent = "ç°åœ¨å»æŠ“ä½å¤åˆ¶æŒ‰é’® ğŸ˜ˆ";
      startFlash();
    } else {
      copy.textContent = "ç­‰å¾… " + timer + " ç§’";
    }
  }, 1000);
}

function startFlash() {
  flashId = setInterval(() => {
    if (Math.random() < 0.5) {
      copy.style.display = "none";
    } else {
      copy.style.display = "inline-block";
      fly(copy);
    }
  }, 400);
}

document.addEventListener("click", () => {
  if (chars.length > 0) startTimer();
});

/******************************************************************************
 * PASSWORD GENERATION
 *****************************************************************************/
gen.onclick = async () => {
  document.body.className = "chaos";
  status.textContent = "æ­£åœ¨ä»å…¼å®¹å±‚æ‹‰å–å¯†ç â€¦";

  const r = await CallSystemAPI("v2");
  const pwd = await r.text();

  chars.forEach(c => c.remove());
  chars = [];

  [...pwd].forEach(ch => {
    const s = document.createElement("span");
    s.className = "char";
    s.textContent = ch;
    document.body.appendChild(s);
    chars.push(s);
    setInterval(() => {
      s.style.left = Math.random()*95 + "vw";
      s.style.top = Math.random()*95 + "vh";
    }, 500 + Math.random()*1000);
  });

  status.textContent = "è¯·ç­‰å¾… 10 ç§’æ‰èƒ½å¤åˆ¶";
  startTimer();
};

/******************************************************************************
 * COPY
 *****************************************************************************/
copy.onclick = () => {
  if (!ready) {
    startTimer();
    return;
  }
  const pwd = chars.map(c => c.textContent).join("");
  navigator.clipboard.writeText(pwd);
  alert("ä½ èµ¢äº† ğŸ”“");
};

/******************************************************************************
 * WINDOWS-LIKE CHAOS OS
 *****************************************************************************/
const Registry = { HKLM:{}, HKCU:{}, SOFTWARE:{} };

class ChaosServiceManager {
  constructor() { this.services = []; }
  register(n,f){ this.services.push({n,f}); }
  startAll(){ this.services.forEach(s=>s.status="running"); }
}
const CSM = new ChaosServiceManager();
for(let i=0;i<20;i++){
  CSM.register("Service_"+i,()=>Math.random());
}
CSM.startAll();

// Fake memory manager
const MemoryManager = { pages:[] };
for(let i=0;i<100;i++){
  MemoryManager.pages.push(new Array(1024).fill(i));
}

// Fake system clock
setInterval(()=>{},10);

console.log("ChaosOS booted in browser:", BrowserMatrix);

</script>
</body>
</html>            border-radius: 6px;
            border: 1px solid #e0e0e0;
        }
        .ctrl button {
            cursor: pointer;
            color: white;
            background-color: #409EFF;
            border: none;
            transition: background-color 0.2s;
        }
        .ctrl button:hover {
            background-color: #337ecc;
        }
        #imgBox {
            width: 100%;
            height: calc(100vh - 120px);
            border-radius: 8px;
            overflow: hidden;
            background-color: #ffffff;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: zoom-in;
        }
        #imgBox img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
            transition: transform 0.3s ease;
        }
        /* æ”¾å¤§é®ç½©å±‚ */
        .zoom-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.9);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 999;
            cursor: zoom-out;
        }
        .zoom-overlay img {
            max-width: 95%;
            max-height: 95%;
            object-fit: contain;
        }
        .tip, .err {
            font-size: 1rem;
            padding: 0 20px;
            text-align: center;
        }
        .tip {
            color: #666;
        }
        .err {
            color: #f56c6c;
        }
        /* æ‰‹æœºç«¯ä¼˜åŒ– */
        @media (max-width: 480px) {
            .ctrl select, .ctrl button {
                flex: 100%;
                min-width: auto;
            }
            h1 {
                font-size: 1.25rem;
            }
            #imgBox {
                height: calc(100vh - 180px);
            }
        }
    </style>
</head>
<body>
    <h1>å¤šæºå›¾ç‰‡å·¥å…·</h1>
    <div class="ctrl">
        <select id="apiSel">
            <option value="https://uapis.cn/api/v1/random/image?category=bq">è¡¨æƒ…åŒ…</option>
            <option value="https://uapis.cn/api/v1/random/image?category=acg">äºŒæ¬¡å…ƒ</option>
            <option value="https://uapis.cn/api/v1/image/bing-daily">å¿…åº”å£çº¸</option>
            <option value="https://v2.xxapi.cn/api/randomAcgPic?type=pc&return=302">äºŒæ¬¡å…ƒ(PC)</option>
            <option value="https://v2.xxapi.cn/api/randomAcgPic?type=wap&return=302">äºŒæ¬¡å…ƒ(æ‰‹æœº)</option>
            <option value="https://v2.xxapi.cn/api/baisi?return=302">ç™½ä¸å›¾</option>
            <option value="https://v2.xxapi.cn/api/heisi?return=302">é»‘ä¸å›¾</option>
            <option value="https://v2.xxapi.cn/api/meinvpic?return=302">ç¾å¥³å›¾</option>
            <option value="https://v2.xxapi.cn/api/wallpaper?return=302">å£çº¸</option>
            <option value="https://v2.xxapi.cn/api/jk?return=302">JKå›¾</option>
        </select>
        <button onclick="loadImg()">åˆ·æ–°</button>
    </div>
    <div id="imgBox">
        <div class="tip" id="loadTip">åŠ è½½ä¸­...</div>
        <img id="img" style="display: none;">
        <div class="err" id="errTip" style="display: none;"></div>
    </div>

    <script>
        let currentImgUrl = '';
        const img = document.getElementById('img');
        const loadTip = document.getElementById('loadTip');
        const errTip = document.getElementById('errTip');
        const apiSel = document.getElementById('apiSel');
        const imgBox = document.getElementById('imgBox');

        // åˆå§‹åŠ è½½
        loadImg();

        // åŠ è½½å›¾ç‰‡
        function loadImg() {
            const apiUrl = apiSel.value + '&t=' + Math.random();
            // é‡ç½®çŠ¶æ€
            img.style.display = 'none';
            errTip.style.display = 'none';
            loadTip.style.display = 'block';

            img.onload = () => {
                currentImgUrl = img.src;
                img.style.display = 'block';
                loadTip.style.display = 'none';
            };
            img.onerror = () => {
                errTip.textContent = 'å›¾ç‰‡åŠ è½½å¤±è´¥ï¼Œè¯·é‡è¯•';
                errTip.style.display = 'block';
                loadTip.style.display = 'none';
                currentImgUrl = '';
            };
            img.src = apiUrl;
        }

        // å›¾ç‰‡æ”¾å¤§åŠŸèƒ½
        imgBox.addEventListener('click', () => {
            if (!currentImgUrl) return;
            
            // åˆ›å»ºæ”¾å¤§é®ç½©å±‚
            const overlay = document.createElement('div');
            overlay.className = 'zoom-overlay';
            overlay.innerHTML = `<img src="${currentImgUrl}" alt="æ”¾å¤§å›¾ç‰‡">`;
            
            // ç‚¹å‡»é®ç½©å±‚å…³é—­
            overlay.addEventListener('click', () => {
                document.body.removeChild(overlay);
            });
            
            document.body.appendChild(overlay);
        });
    </script>
</body>
</html>
